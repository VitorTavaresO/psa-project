# Análise de Segurança, Desempenho e Confiabilidade

| **#** | **Tipo**                               | **Afeta qual pilar**   | **Indicativo** | **Arquivo**                                                                                                                                                          | **Informativos**                                                                                                                                                                                                                                                                                  |
| ----------- | -------------------------------------------- | ---------------------------- | -------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1           | BUG, Code Smells                             | Segurança, confiabilidade   | E                    | app/views/NewServerView/utils/completeUrl.ts                                                                                                                               | Arquivo com 2 BUGs 1 code smells relacionados aos regex                                                                                                                                                                                                                                                 |
| 2           | Sem cobertura de teste                       | Segurança                   | E                    | app/lib/methods/helpers/formatAttachmentUrl.ts                                                                                                                             | Sem cobertura de teste                                                                                                                                                                                                                                                                                  |
| 3           | Code Smells, Sem cobertura de teste          | Segurança                   | E                    | app/lib/methods/helpers/getAvatarUrl.ts                                                                                                                                    | Sem cobertura de teste e com 1 code smells                                                                                                                                                                                                                                                              |
| 4           | Sem cobertura de teste                       | Segurança                   | E                    | app/lib/methods/helpers/media.ts                                                                                                                                           | Sem cobertura de teste                                                                                                                                                                                                                                                                                  |
| 5           | Sem cobertura de teste                       | Segurança                   | E                    | app/lib/methods/helpers/random.ts                                                                                                                                          | Sem cobertura de teste                                                                                                                                                                                                                                                                                  |
| 6           | Sem cobertura de teste                       | Segurança                   | E                    | app/containers/LoginServices/serviceLogin.ts                                                                                                                               | Sem cobertura de teste                                                                                                                                                                                                                                                                                  |
| 7           | BUG, Code Smells, Sem cobertura de teste     | confiabilidade               | C                    | app/views/AuthenticationWebView.tsx                                                                                                                                        | Embora o sonar não tenha considera como code smells existem trechos de códigos comentados                                                                                                                                                                                                             |
| 8           | BUG                                          | confiabilidade               | C                    | app/containers/message/Emoji.tsx                                                                                                                                           | Bug relacionado à regex                                                                                                                                                                                                                                                                                |
| 9           | BUG, cobertura parcial de teste              | confiabilidade               | C                    | app/containers/message/Components/Attachments/CollapsibleQuote/index.tsx                                                                                                   | Bug relacionado à atribuição de valor a variavel                                                                                                                                                                                                                                                     |
| 10          | BUG, Sem cobertura de teste, Code Smells     | confiabilidade               | C                    | app/containers/UIKit/index.tsx                                                                                                                                             | 12 BUGS ( a maioria relacionado ao uso do useContext) e 2 code smells                                                                                                                                                                                                                                   |
| 11          | Code Smells, BUG, Sem cobertura de teste     | confiabilidade               | C                    | app/views/RoomView/index.tsx                                                                                                                                               | 16 code smells e 1 BUG, embora o sonar não tenha considerado, na minha visão existem mais code smells (God Class ). Os code smells mais criticos se referiam à refatorar a complexidade das funções, ao uso redundante do await, e a métodos não utilizados                                      |
| 12          | BUG, Code Smells, Sem cobertura de teste     | confiabilidade               | C                    | app/views/ProfileView/index.tsx                                                                                                                                            | 1 BUG e 3 code smells (2 relacionados a métodos complexos)                                                                                                                                                                                                                                             |
| 13          | BUG, Sem cobertura de teste                  | confiabilidade               | C                    | app/views/NotificationPreferencesView/index.tsx                                                                                                                            | 2 BUGs relacionados a atribuição da mesma variavel de estado no próprio setter ex: setSwitchValue(switchValue)                                                                                                                                                                                       |
| 14          | BUG, Sem cobertura de teste                  | confiabilidade               | C                    | app/views/UserPreferencesView/ListPicker.tsx                                                                                                                               | 1 BUGs relacionados a atribuição da mesma variavel de estado no próprio setter ex: setOption(option)                                                                                                                                                                                                 |
| 15          | BUG, Code Smells, Sem cobertura de teste     | confiabilidade               | C                    | app/views/RoomInfoView/components/RoomInfoViewTitle.tsx                                                                                                                    | 1 BUG (Converta o condicional em um booleano para evitar vazamento de valor) e 1 code smell                                                                                                                                                                                                             |
| 16          | BUG, Code Smells, Sem cobertura de teste     | confiabilidade               | C                    | app/sagas/rooms.js                                                                                                                                                         | 1 BUG (relacionado à necessidade do uso do await) 1 code smell relacionado ao método muito complexo                                                                                                                                                                                                   |
| 17          | BUG, Code Smells, Sem cobertura de teste     | confiabilidade               | C                    | app/views/WorkspaceView/ServerAvatar.tsx                                                                                                                                   | 1 BUG (Converta o condicional em um booleano para evitar vazamento de valor) e 1 code smell relacionado a comentários                                                                                                                                                                                  |
| 18          | BUG, Sem cobertura de teste                  | confiabilidade               | C                    | app/views/RoomInfoEditView/SwitchContainer.tsx                                                                                                                             | 1 BUG (Converta o condicional em um booleano para evitar vazamento de valor)                                                                                                                                                                                                                            |
| 19          | Code Smells, BUG, cobertura parcial de teste | confiabilidade               | C                    | app/containers/MessageComposer/hooks/useAutocomplete.ts                                                                                                                    | 1 BUGs relacionados a atribuição da mesma variavel de estado no próprio setter ex: setOption(option), e 4 code smells relacionado ao uso reduntante do await e a métodos complexos                                                                                                                  |
| 20          | BUG, cobertura parcial de teste              | confiabilidade               | C                    | app/containers/MessageComposer/hooks/useAutoSaveDraft.ts                                                                                                                   | 1 BUG (Esperava uma atribuição ou chamada de função e, em vez disso, viu uma expressão "() => {};")                                                                                                                                                                                                |
| 21          | BUG, Code Smells, cobertura parcial de teste | confiabilidade               | C                    | app/lib/encryption/utils.ts                                                                                                                                                | 1 BUG (Substitua ByteBuffer.wrap por uma função construtora) e 1 code smell relacionado a utilização de um metodo depreciado. Embora o sonar não considere, na minha visão isso afeta o pilar de segurança pois se trata de um arquivo onde se realiza algumas incriptação e conversão base64 |
| 22          | BUG                                          | confiabilidade               | B                    | app/lib/encryption/helpers/getMessageUrlRegex.ts                                                                                                                           | 2 BUGs relacionados ao regex                                                                                                                                                                                                                                                                            |
| 23          | Vulnerabilidade                              | Segurança                   | A                    | AndroidManifest.xml                                                                                                                                                        | O aplicativo é compatível com o Android 5.0-5.0.2 (API 21), que possui vulnerabilidades não corrigidas. Isso expõe os usuários a riscos, já que esses dispositivos não recebem mais atualizações de segurança.                                                                                |
| 24          | Code Smells                                  | Segurança                   | B                    | network_security_config.xml                                                                                                                                                | O aplicativo permite configurações de segurança personalizadas, mas permite tráfego de texto simples e certificados instalados pelo usuário.                                                                                                                                                       |
| 25          | Code Smells                                  | Manutenabilidade             | B                    | SharedPreferencesHelper.java                                                                                                                                               | O aplicativo executa operações de I/O de arquivo.                                                                                                                                                                                                                                                     |
| 26          | Code Smells                                  | Segurança                   | A                    | LoginFragment.java                                                                                                                                                         | Atividades são iniciadas sem verificações adequadas, o que pode levar a acessos não autorizados ou sequestro de intents.                                                                                                                                                                            |
| 27          | Code Smells                                  | Manutenabilidade             | B                    | JsonAdapter.java                                                                                                                                                           | Reflexão é utilizada, o que pode introduzir riscos de segurança (como burlar controles de acesso) e tornar o código mais difícil de manter.                                                                                                                                                        |
| 28          | Vulnerabilidade                              | Segurança                   | B                    | ChatRoomFragment.java                                                                                                                                                      | Clipboard é acessado, o que pode expor informações sensíveis se não forem tratados corretamente.                                                                                                                                                                                                   |
| 29          | Vulnerabilidade                              | Segurança                   | A                    | SystemLibraryLoader.java                                                                                                                                                   | Código nativo é carregado, o que pode introduzir riscos de segurança (como injeção de código) se as bibliotecas não forem devidamente validadas.                                                                                                                                                 |
| 30          | Vulnerabilidade                              | Segurança                   | A                    | Okio,java                                                                                                                                                                  | TCP Sockets são usados, o que pode expor o aplicativo a ataques baseados na rede.                                                                                                                                                                                                                      |
| 31          | Vulnerabilidade                              | Segurança                   | A                    | UriKt.java                                                                                                                                                                 | O aplicativo consulta dados sensíveis (SMS, contatos), o que pode causar violações de privacidade.                                                                                                                                                                                                   |
| 32          | Code Smells                                  | Segurança                   | B                    | Buffer.java, HashingSource.java                                                                                                                                            | Message digests são usadas, mas algoritmos fracos (como MD5) podem causar vulnerabilidades de segurança.                                                                                                                                                                                              |
| 33          | Code Smells                                  | Desempenho, Manutenabilidade | E                    | Análise Profiler main (UI Thread)                                                                                                                                         | Execução de tarefas pesadas no thread principal, causando travamentos                                                                                                                                                                                                                                 |
| 34          | Code Smells                                  | Desempenho                   | C                    | Análise Profiler OkHttp[http://10.0.2.2:8081/](vscode-file://vscode-app/c:/Program%20Files/VS%20Code/resources/app/out/vs/code/electron-browser/workbench/workbench.html)... | Várias chamadas simultâneas ao servidor local durante execução                                                                                                                                                                                                                                      |
| 35          | Code Smells                                  | Desempenho                   | C                    | Análise Profiler Firebase Background Thread #0~3                                                                                                                          | Firebase criando várias threads que podem competir por recursos                                                                                                                                                                                                                                        |
| 36          | Code Smells                                  | Desempenho                   | C                    | Análise Profiler mqt_js, mqt_native_modules                                                                                                                               | Ponte JS-nativa com possível gargalo de comunicação                                                                                                                                                                                                                                                  |
| 37          | Code Smells                                  | Desempenho                   | D                    | Análise Profiler OkHttp Dispatcher, TaskRunner                                                                                                                            | Consumo excessivo de threads por tarefas de rede                                                                                                                                                                                                                                                        |
| 38          | Code Smells                                  | Desempenho, Manutenabilidade | C                    | Análise Profiler bugsnag-anr-collector, IO thread                                                                                                                         | Monitoramento pode consumir CPU e memória em dispositivos limitados                                                                                                                                                                                                                                    |
| 39          | Vulnerabilidade                              | Segurança                   | E                    | Heap Dump (.hprof) Global Heap (Strings)                                                                                                                                   | Dados como tokens/API_KEY persistem em memória por tempo indeterminado                                                                                                                                                                                                                                 |
| 40          | Vulnerabilidade                              | Segurança                   | E                    | Heap Dump (.hprof) Autenticação / Firebase                                                                                                                               | Dados como TOKEN_CACHED, AUTHENTICATION_INFO, API_KEY estão em texto                                                                                                                                                                                                                                   |

## Estatísticas da Análise

### Distribuição por Tipo de Problema

* **BUG:** 22 ocorrências
* **Code Smells:** 32 ocorrências
* **Vulnerabilidade:** 8 ocorrências
* **Sem cobertura de teste:** 15 ocorrências

### Distribuição por Pilar Afetado

* **Segurança:** 17 problemas
* **Confiabilidade:** 15 problemas
* **Desempenho:** 6 problemas
* **Manutenabilidade:** 3 problemas

### Distribuição por Indicativo de Prioridade

* **A (Crítico):** 5 problemas
* **B (Alto):** 6 problemas
* **C (Médio):** 16 problemas
* **D (Baixo):** 1 problema
* **E (Informativo):** 10 problemas

### Principais Áreas de Preocupação

1. **Segurança de Dados:** Tokens e chaves em texto plano na memória
2. **Compatibilidade Android:** Suporte a versões vulneráveis do Android
3. **Cobertura de Testes:** Múltiplos arquivos críticos sem testes
4. **Regex e Validação:** Problemas recorrentes com expressões regulares
5. **Performance:** Operações pesadas na thread principal
